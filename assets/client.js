var Nt=Object.defineProperty;var a=(n,e)=>Nt(n,"name",{value:e,configurable:!0});function ct(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}a(ct,"camelCaseToKebabCase");function O(n){return Array.isArray(n)?n:[n]}a(O,"ensureArray");function j(n,e){for(let t=0,i=n.length;t<i;t++)if(n[t]===e)return;n.push(e)}a(j,"addUnique");var B=class{static{a(this,"BoundClass")}constructor(){let e=Object.getPrototypeOf(this),t=Object.getOwnPropertyNames(e);for(let i=0,s=t.length;i<s;i++){if(t[i]==="constructor")continue;let r=Object.getOwnPropertyDescriptor(e,t[i]);typeof r.get>"u"&&typeof r.set>"u"&&(this[t[i]]=this[t[i]].bind(this))}}};function tt(n,e=!1){return JSON.stringify(n,St(),e?e===!0?4:e:null)}a(tt,"stringify");function et(n,e=!1){if(!e)return JSON.parse(n);try{return JSON.parse(n)}catch{return{}}}a(et,"parse");function nt(n,e){return e?et(tt(n)):structuredClone(n)}a(nt,"clone");function St(n=new WeakSet){return function(e,t){if(typeof t=="object"&&t!==null){if(n.has(t))return;n.add(t)}return t}}a(St,"duplicateReplacer");function at(n){return n instanceof Promise}a(at,"isPromise");var N=a((n,{method:e="get",controller:t,headers:i,params:s,timeout:r,content:c,...o}={})=>{t||(t=new AbortController);let{body:l,contentType:u}=mt(o?.body),f=new Promise(async(E,h)=>{i=await Ot(n,i,u,e),s&&(s=new URLSearchParams(s)),r=r?setTimeout(()=>t.abort(),r):void 0;try{let d=await fetch(s?`${n}?${s.toString()}`:n,{...o,headers:i,body:l,method:e?.toUpperCase(),signal:t.signal});return d.ok?E({data:await d[c||At(d.headers.get("content-type"))](),status:d.status,statusText:d.statusText,headers:d.headers}):h(new Error(await d.text()||d.status+""+d.statusText))}catch(d){if(!t.signal.aborted)return h(d)}finally{clearTimeout(r)}});return f.abort=()=>t.abort(),f},"request");N.get=(n,e)=>N(n,{method:"get",...e});N.post=(n,e)=>N(n,{method:"post",...e});N.head=(n,e)=>N(n,{method:"head",...e});N.put=(n,e)=>N(n,{method:"put",...e});N.delete=(n,e)=>N(n,{method:"delete",...e});N.connect=(n,e)=>N(n,{method:"connect",...e});N.options=(n,e)=>N(n,{method:"options",...e});N.trace=(n,e)=>N(n,{method:"trace",...e});N.patch=(n,e)=>N(n,{method:"patch",...e});function mt(n){return n instanceof FormData?{body:n,contentType:"auto"}:{body:JSON.stringify(n),contentType:"default"}}a(mt,"transformBody");async function Ot(n,e,t,i){return e instanceof Headers||(e=new Headers(typeof e=="object"?e:{})),e.append("accept","application/json, text/plain, */*"),e.append("path",n),e.append("method",i||"GET"),e.append("sec-fetch-mode","cors"),e.append("sec-fetch-site","same-origin"),t!=="auto"&&!e.get("Content-Type")&&e.append("Content-Type",t!=="default"?t:"application/json"),e}a(Ot,"buildHeaders");function At(n){return typeof n!="string"?"blob":n.includes("application/json")?"json":n.includes("application/octet-stream")?"arrayBuffer":n.includes("multipart/form-data")?"formData":n.includes("text/")?"text":"blob"}a(At,"convertResponse");function J(n,e="base64"){if(typeof Buffer<"u")return Buffer.from(n).toString(e);let t="";switch(e){case"base64":t=btoa(n);break;case"hex":for(let i=0,s=n.length;i<s;i++)t+=n[i].charCodeAt(0).toString(16).padStart(2,"0");break;case"ascii":case"binary":default:throw new Error("Not ready for this encoding")}return t}a(J,"encode");function ft(n,e="base64"){if(typeof Buffer<"u")return Buffer.from(n,e).toString();let t="";switch(e){case"base64":t=atob(n);break;case"hex":var i=n.match(/.{1,2}/g)||[];for(let s=0,r=i.length;s<r;s++)t+=String.fromCharCode(parseInt(i[s],16));break;case"ascii":case"binary":default:throw new Error("Not ready for this encoding")}return t}a(ft,"decode");function it(n){return n.charAt(0).toUpperCase()+n.slice(1)}a(it,"capitalize");function Y(n){try{return!!new URL(n)}catch{return!1}}a(Y,"isValidUrl");var G="assets",T=a((n,e,t)=>Object.defineProperty(n,e,{value:t,writable:!1,configurable:!1}),"defineReadonly");function X(n){let e=new URL(window.location.href),[t]=n?.includes("?")?n.split(/\?(.*)/s):[n];return t.startsWith(".")?e.pathname+="/"+t:e.pathname=t,e.href}a(X,"buildUrl");var V=class extends Function{static{a(this,"FunctionClass")}constructor(e){return Object.setPrototypeOf(e,new.target.prototype)}};var lt="Vistta_Context_",m=Symbol("Fragment"),x=Symbol("TextNode"),kt=Symbol("Component"),w=class n{static{a(this,"Element")}constructor(e,t,...i){this.props=t||{},this.children=i;let s=typeof e;if(e?.prototype instanceof y||s==="function")this.type=y.Node,this.props.children=i,this.Component=e;else{if(s!=="string"&&s!=="symbol")return null;t?.ref!=null&&(t.ref instanceof S&&(t.ref=t.ref()),this.ref=t.ref,delete this.props.ref),t?.key!=null&&(t.key instanceof S&&(t.key=t.key()),typeof t.key=="number"?this.key=""+t?.key:this.key=t?.key,delete this.props.key),this.type=e}}toString(){let e=this.children?.reduce((s,r)=>s+r,"");if(typeof this.type!="string")return e;let t="",i=Object.keys(this.props||{});for(let s=0,r=i.length;s<r;s++){let c=i[s],o=c==="style"?xt(this.props[c]):this.props[c];o==null||o===!1||["function","object"].includes(typeof o)||(o===!0?t+=` ${c}`:t+=` ${c}="${o}"`)}return`<${this.type}${t}>${e}</${this.type}>`}clone(e,t){if(e!==!1)if(e){let{style:i,...s}=e||{};e=Object.assign(ut(this.props),s),e.style=Object.assign(e.style||{},i||{})}else e=ut(this.props);return t!==!1&&(t=this?.children?.map(i=>i instanceof n?i.clone(void 0,!0):i)),new n(this.type,e,t)}},S=class extends V{static{a(this,"Mutation")}constructor(e,t){super(t),this.id=e,this.callback=t}},C=class extends V{static{a(this,"Context")}#t;#e;#i;#n;#o;#c=[];constructor(e,t,i,s,r){if(typeof e!="string"||e.length==0)throw new Error("TypeError: Invalid context key.");if(typeof t!="object")throw new Error("TypeError: Cannot create context with a non-object value.");super(()=>this),this.#t=e;try{this.#e=nt(t)}catch{throw new Error("TypeError: Cannot create context with a non serializable object as default value.")}if(this.#i=i==="session"?sessionStorage:i==="local"||i==="storage"?localStorage:null,this.#i)try{this.#e=et(ft(this.#i.getItem(J(lt+e,"hex")),"hex"))??this.#e}catch{}let c=Object.keys(s||{});if(c.length>0){let o=a((l,u)=>{let f=typeof r;f==="function"?r.call(this,l,u,this.value):f==="object"&&r?.[l]?.call(this,u,this.value)},"controllerFn");for(let l=0,u=c.length;l<u;l++){let f=c[l];if(["valueOf","toString","setValue","register","proxy"].includes(f))throw new Error(`Invalid action name "${f}".`);let E=s[f];this[f]=((...h)=>{o(f,"pending");let d=new AbortController,p=new Promise(b=>{d.signal.onabort=()=>{o(f,"rejected"),b()};try{let g=E(nt(this.#e),...h);at(g)?g.then(k=>{d.signal?.aborted||(Object.assign(this.proxy(),k),b(),o(f,"completed"))}).catch(()=>{o(f,"rejected"),b()}):d.signal?.aborted||(Object.assign(this.proxy(),g),b(),o(f,"completed"))}catch(g){throw o(f,"rejected"),g}});return p.abort=(...b)=>d.abort(...b),p}).bind(this)}}}get key(){return this.#t}get value(){return this.#n||(this.#n=new Proxy(this.#e,{set:a(()=>!0,"set"),deleteProperty:a(()=>!0,"deleteProperty"),defineProperty:a(()=>!0,"defineProperty")})),this.#n}valueOf(){return this.value}toString(){return JSON.stringify(this.#e)}proxy(e){let t=this.#c;if(typeof e?.set=="function"&&t.push(e.set),this.#o)return this.#o;let i=a(()=>{if(this.#i)try{this.#i.setItem(J(lt+this.#t,"hex"),J(tt(this.#e),"hex"))}catch(s){console.error(s)}},"updateCache");return this.#o=new Proxy(this.#e,{get(s,r){return typeof e?.get=="function"&&e.get(this.path?`${this.path}.${r}`:r,s[r]),s[r]},set(s,r,c){if(s[r]===c||JSON.stringify(s[r])===JSON.stringify(c))return!0;s[r]=c;for(let o=0,l=t.length;o<l;o++)t[o](this.path?`${this.path}.${r}`:r,c);return i(),!0}}),this.#o}},M=class{static{a(this,"Ref")}constructor(e){this.node=e}},y=class{static{a(this,"Component")}children=[];static get Node(){return kt}get props(){let e={},t=Object.keys(this);for(let i=0,s=t.length;i<s;i++){let r=t[i];r==="render"||r==="children"||(e[r]={get:a(()=>this[r],"get"),set:a(c=>this[r]=c,"set")})}return e}constructor(){let e=Object.getPrototypeOf(this),t=Object.getOwnPropertyNames(e);for(let i=0,s=t.length;i<s;i++){if(t[i]==="constructor")continue;let r=Object.getOwnPropertyDescriptor(e,t[i]);typeof r.get>"u"&&typeof r.set>"u"&&(this[t[i]]=this[t[i]].bind(this))}}},R=class extends y{static{a(this,"Suspense")}#t=0;#e;get fulfilled(){return this.#t==0}register(){return this.#t++,console.log("register",this.#t),this}resolve(){this.#t--,console.log("resolve",this.#t),this.#t==0&&this.#e(!0)}render(e){return e&&(this.#e=e),this.#t==0?this.children:this.fallback}},P=class extends y{static{a(this,"Profiler")}callback;#t;#e=0;onConnect(){this.callback(performance.now()-this.#t)}render(){return this.callback,this.children;return this.#t=performance.now(),this.children}record(e,t){return()=>{let i=performance.now();e(),this.#e=performance.now()-i,t(this)}}end(){let e=this.#e;this.#e=0,this.callback(e)}},ht={If:class extends y{static{a(this,"If")}condition;render(){return this.condition&&this.children}},Each:class extends y{static{a(this,"Each")}of;as;render(){if(typeof this.of!="object"||typeof this.as!="function")return null;let n=[];if(Array.isArray(this.of))for(let e=0,t=this.of.length;e<t;e++)n.push(this.as(this.of[e],e));else{let e=Object.keys(this.of);for(let t=0,i=e.length;t<i;t++)n.push(this.as(this.of[e[t]],e[t]))}return n}}},F=class extends y{static{a(this,"Safe")}error;fallback;catch(e){return()=>{try{e()}catch(t){console.error(t),this.error=t}}}render(){return this.error?this.fallback:this.children}},$=class n extends y{static{a(this,"Form")}static Ref=M;static get DEFAULT_ERROR_MESSAGE(){if(!this._defaultErrorMessage){let e=document.createElement("input");e.type="text",e.required=!0,this._defaultErrorMessage=e.validationMessage}return this._defaultErrorMessage}#t;#e=[];#i;#n={};#o={};#c={};#a={};#r={};#s;ref;id;name;className;autocomplete;style;onsubmit;onSubmit;oninvalid;onInvalid;get path(){return this.#e}onConnect(){this.#i||!this.ref||this.ref.node||Object.assign(this.ref,{node:this.#t,watch:a((...e)=>this.watch(...e),"watch"),unwatch:a((...e)=>this.unwatch(...e),"unwatch"),reset:a(e=>this.reset(e),"reset"),clear:a(e=>this.clear(e),"clear"),submit:a(()=>this.submit(),"submit"),values:a(()=>this.values(),"values"),validate:a(e=>this.validate(e),"validate")})}render(){return this.#i?this.name?this.className||this.style?new w("div",{className:this.className,style:this.style},...this.children):new w(m,{},...this.children):null:(this.#s=typeof this.oninvalid=="function"||typeof this.onInvalid=="function",new w("form",{ref:a(e=>this.#t=e,"ref"),className:this.className,autocomplete:this.autocomplete,onreset:a(()=>this.reset(),"onreset"),oninvalid:this.oninvalid||this.onInvalid,onsubmit:a(e=>{e.preventDefault(),this.validate()&&(e.values=this.values(),typeof this.onsubmit=="function"?this.onsubmit?.(e):typeof this.onSubmit=="function"&&this.onSubmit?.(e))},"onsubmit"),style:this.style},...this.children))}register(e){if(e instanceof n){this.#i=e,this.#e=[...this.#i.path,this.name||this.id];return}let{type:t,attributes:i,node:s}=e||{};if(!s||t!=="input"&&t!=="textarea"&&t!=="select"&&i.role!=="input"||i.type==="submit")return;let r=i.name||i.id;if(r){if(i.type==="radio"?(this.#n[r]||(this.fields[r]=[]),this.#n[r].push(s)):this.#n[r]=s,this.#o[r]=Z(s),this.#i)return this.#i.register({type:t,props:{name:[...this.path,r].join("."),...i},node:s});this.#c[r]=i.required,this.#a[r]=i.validator instanceof S?i.validator():i.validator,s.addEventListener(t==="select"?"change":"input",c=>{this.#s||s.setCustomValidity?.("");for(let o=0,l=this.#r[r]?.length;o<l;o++)this.#r[r][o](c);for(let o=0,l=this.#r["*"]?.length;o<l;o++)this.#r["*"][o](c)})}}watch(...e){if(e.length==0||this.#i)return;e.length==1&&e.unshift("*");let[t,i]=e;if(!this.#r[t]){this.#r[t]=[i];return}for(let s=0,r=this.#r[t]?.length;s<r;s++)if(this.#r[t][s]===i)return;this.#r[t].push(i)}unwatch(...e){if(e.length==0||this.#i)return;e.length==1&&e.unshift("*");let[t,i]=e;for(let s=0,r=this.#r[t]?.length;s<r;s++)if(this.#r[t][s]===i){this.#r[t].splice(s,1);return}}reset(e="*"){if(e==="*"){let s=Object.keys(this.#n);for(let r=0,c=s.length;r<c;r++){let o=this.#n[s[r]],l=this.#o[s[r]];o.value!==l&&(o.value=l,o.dispatchEvent(new Event(o.localName==="select"?"change":"input")),this.#s||o.setCustomValidity?.(""))}return}let t=this.#n[e],i=this.#o[e];t.value!==i&&(t.value=i,t.dispatchEvent(new Event(t.localName==="select"?"change":"input")),this.#s||t.setCustomValidity?.(""))}validate(e){if(e&&!this.#n[e])return null;let t=[],i=e?[e]:Object.keys(this.#n);for(let r=0,c=i.length;r<c;r++){let o=this.#n[i[r]],l=Z(o);if(this.#c[i[r]]===!0&&!l){this.#s?t.push({field:o,error:n.DEFAULT_ERROR_MESSAGE}):o.setCustomValidity?.(n.DEFAULT_ERROR_MESSAGE);continue}let u=this.#a[i[r]],f=typeof u=="function"?u(l):null;typeof f=="string"?this.#s?t.push({field:o,error:f}):o.setCustomValidity?.(f):f===!1?this.#s?t.push({field:o,error:n.DEFAULT_ERROR_MESSAGE}):o.setCustomValidity?.(n.DEFAULT_ERROR_MESSAGE):this.#s||o.setCustomValidity?.("")}if(!this.#s)return this.#t.reportValidity();if(t.length===0)return!0;let s=new Event("invalid");return s.errors=t,this.#t.dispatchEvent(s),!1}clear(e="*"){if(e==="*"){let i=Object.keys(this.#n);for(let s=0,r=i.length;s<r;s++){let c=this.#n[i[s]];c.value!==""&&(c.value="",c.dispatchEvent(new Event(c.localName==="select"?"change":"input")))}return}let t=this.#n[e];t.value!==""&&(t.value="",t.dispatchEvent(new Event(t.localName==="select"?"change":"input")))}submit(){this.#t.requestSubmit()}values(){let e={},t=Object.keys(this.#n);for(let i=0,s=t.length;i<s;i++){let r=t[i];if(r.includes(".")){let c=e,o=r.split(".");for(let l=0,u=o.length;l<u;l++){let f=o[l];l===u-1?c[f]=Z(this.#n[r]):(c[f]=c[f]||{},c=c[f])}}else e[r]=Z(this.#n[r])}return e}};T(window,"Fragment",m);T(window,"prop",(n,e)=>new S(n,e));T(window,"child",(n,e)=>new S(n,e));T(window,"element",(n,...e)=>{let t=new w(...e);return t.id=n,t});function ut(n){let e=a(t=>{if(typeof t=="object")if(Array.isArray(t)){let i=[];for(let s=0,r=t.length;s<r;s++)i[s]=e(t[s]);return i}else{let i={},s=Object.keys(t||{});for(let r=0,c=s.length;r<c;r++)i[s[r]]=e(t[s[r]]);return i}else return t},"clone");return e(n)}a(ut,"cloneProps");function xt(n){let e=Object.keys(n||{}),t="";for(let i=0,s=e.length;i<s;i++){let r=n[e[i]];typeof r=="string"&&(t+=` ${ct(e[i])}: ${r};`)}return t=t.trim(),t===""?null:t}a(xt,"styleToString");function Z(n){if(Array.isArray(n)){for(let e=0,t=n.length;e<t;e++)if(n[e].checked)return n[e].value;return null}return n.type==="checkbox"?n.checked:n.value}a(Z,"getFieldValue");var dt=new Error("Event strict mode active"),Ct=0,A=class extends Error{static{a(this,"VirtualDomError")}constructor(e){super(e),this.name="Virtual Dom Error"}},H=class n{static{a(this,"VirtualDom")}active=!1;running=!1;queue=[];keys={};affectedComponents=[];profilers=[];styleSheets={};constructor(e,t,i){this.pathname=e,this.host=t,this.config=i}createElement(e){return e==="fragment"?document.createDocumentFragment():document.createElement(e)}createTextNode(e){return document.createTextNode(e)}setAttribute(e,t,i,s){if(t==="validator"&&typeof i=="function"||e.attributes[t]===i)return;e.attributes[t]=i;let r=e.node;if(!s&&/^on\w.*/.test(t)&&typeof i=="function"){r[t.toLowerCase()]=(c,...o)=>{try{c.stritMode=()=>{if(c.target!==r)throw dt},i(c,...o)}catch(l){if(l!==dt)throw l}};return}if(t==="className"&&(t="class"),i==null||i===!1)r.removeAttribute(t);else if(t==="value")r.value=i;else if(t==="style"&&typeof i=="object"){let c=Object.keys(i);for(let o=0,l=c.length||0;o<l;o++)r.style.setProperty(c[o],i[c[o]])}else r.setAttribute(t,typeof i=="boolean"?"":i);t.startsWith("style-")&&i&&this.addStyleSheet(t.replace("style-",""),!0),t==="id"&&i&&r.style.setProperty("anchor-name",`--a_${i.toLowerCase()}`),t==="anchor"&&r.style.setProperty("position-anchor",`--a_${i.toLowerCase()}`)}render(e){this.active=!0,this.running=!0;let t={type:n,node:this.createElement("fragment")};this.virtualTree=rt(this,t,e,{depth:0,components:[]});for(let i=0,s=this.config?.styles?.length||0;i<s;i++)this.addStyleSheet(Object.keys(this.config.styles[i])[0].replace("style-",""));return this.replaceStyleSheets(),this.host.replaceChildren(t.node),t.node=this.host,this.snapshot=pt(),requestAnimationFrame(()=>this.update()),this}enqueue(e){if(!Array.isArray(e))throw new A("Internal Error #001");this.queue.push(...e),!(!this.active||this.running)&&(this.running=!0,this.snapshot=pt(),requestAnimationFrame(()=>this.update()))}update(){let e=performance.now();for(;this.queue.length>0;)if(this.queue.shift().update?.(),performance.now()-e>16)return requestAnimationFrame(()=>this.update());let t=this.affectedComponents;this.affectedComponents=[];for(let s=0,r=t.length;s<r;s++)t[s].onUpdate?.();let i=this.profilers;this.profilers=[];for(let s=0,r=i.length;s<r;s++)i[s].end();Tt(this.snapshot),this.running=!1}disable(){if(!this.virtualTree)throw new A("Virtual Dom not rendered");z(this.virtualTree,e=>{e.type===y.Node&&e.component?.onDisconnect?.()}),this.active=!1,this.running=!1}enable(){if(!this.virtualTree)throw new A("Virtual Dom not rendered");this.active=!0,this.running=!0,z(this.virtualTree,i=>{i.type===y.Node&&i.component?.onConnect?.()});let e=this.createElement("fragment"),t=this.virtualTree.node||this.virtualTree.firstNode;if(t){let i=this.virtualTree.lastNode;if(!i||t===i)e.appendChild(t);else{let s=t;for(;s;){let r=s.nextSibling;e.appendChild(s),s===i?s=null:s=r}}}return this.replaceStyleSheets(),this.host.replaceChildren(e),this.next(),this}addStyleSheet(e,t){if(e=`/${G}/${e}${t?".scoped":""}.css`,this.styleSheets[e])return;let i=document.querySelector(`link[rel="stylesheet"][href="${e}"]`);i||(i=document.createElement("link"),i.rel="stylesheet",i.href=e,document.head.appendChild(i)),this.styleSheets[e]=i}replaceStyleSheets(){let e=document.head.querySelectorAll('link[rel="stylesheet"]'),t={};for(let s=0,r=e.length;s<r;s++){let c=e[s],o=c.href.replace(c.baseURI,"/");t[o]=!0,!this.styleSheets[o]&&c.remove()}let i=Object.keys(this.styleSheets);for(let s=0,r=i.length;s<r;s++)t[i[s]]||document.head.appendChild(this.styleSheets[i[s]])}};function rt(n,e,t,i,s){if(t==null||t===!1)return null;if(t instanceof w){if(t.type==null)return null}else if(Array.isArray(t))t=new w(m,null,t);else if(t instanceof S){let r=t;t=new w(m),t.id=r.id,t.mutations=[],t.mutation=L(n,t,r,q(r,c=>_(n,t,null,O(c))),U(n,r,c=>t.children=O(c)))}else if(typeof t=="function")t=new w(t);else{if(typeof t=="object"||t instanceof Promise)throw new A(`${it(typeof t)} is not a valid Element`);t=new w(x,null,""+t)}if(t.mutations=[],t.parent=e,t.context=i,t.type===x)return t.node=n.createTextNode(t.children[0]),W(e,t,s),t;if(typeof t.type=="string"){if(t.key?.length>0){if(t.key instanceof S)throw new A("Internal Error #002");if(n.keys[t.key]==null)n.keys[t.key]={type:t.type,node:n.createElement(t.type)};else if(n.keys[t.key].type!==t.type)throw new A(`Key ${t.key} already in use.`);t.node=n.keys[t.key].node}else t.node=n.createElement(t.type);if(t.ref instanceof S)throw new A("Internal Error #003");typeof t.ref=="function"?t.ref(t.node):t.ref instanceof M&&(t.ref.node=t.node),t.node._element=t,t.attributes={};let r=Object.keys(t.props),c=I(t.props.disabled)||I(t.props.readOnly);for(let o=0,l=r.length;o<l;o++){let u=t.props[r[o]];u instanceof S?L(n,t,u,q(u,f=>n.setAttribute(t,r[o],f,I(t.props.disabled)||I(t.props.readOnly))),U(n,u,f=>n.setAttribute(t,r[o],f,c))):n.setAttribute(t,r[o],u,c)}return v(n,t,t.children,i),W(e,t,s),i.form?.register(t),t}if(t.type===m)return v(n,t,t.children,i,s),t;if(t.type===y.Node){let r;if(t.Component.prototype instanceof y)r=new t.Component;else{if(r=t.Component(),typeof r!="object"||typeof r.render!="function")throw new A("Invalid Function Component format");r=Object.assign(new y,r)}i.components.push(r),t.attributes={};let c={};t.Component===$?i.form?r.register(i.form):i.form=r:(t.Component,P,t.component===F&&(i.safe=r));let o=Object.keys(t.props);for(let f=0,E=o.length;f<E;f++)r[o[f]]??=!0;let l=Object.getOwnPropertyNames(r);for(let f=0,E=l.length;f<E;f++){let h=l[f];if(h==="render"||h==="onConnect"||h==="onDisconnect")Object.defineProperty(r,h,{configurable:!1,enumerable:!1,value:r[h].bind(r)});else if(h==="onUpdate"){let d=r.onUpdate;Object.defineProperty(r,"onUpdate",{configurable:!1,enumerable:!1,value:a(()=>(d.call(r,c),c={}),"value")})}else if(r[h]instanceof C){let d=r[h];if(!i["#"+d.key]){let p={},b={};i["#"+d.key]=d.proxy({get:a((g,k)=>{p[g]||(p[g]=[]),n.mutation&&(j(p[g],n.mutation),b[g]=k)},"get"),set:a((g,k)=>{b[g]!=k&&(b[g]=k,c[h]=!0,p[g]&&n.enqueue(p[g]))},"set")})}Object.defineProperty(r,h,{configurable:!1,enumerable:!1,get:a(()=>i["#"+d.key],"get")})}else{let d=[];if(t.attributes[h]=r[h],t.props[h]instanceof S){let p=t.props[h];p.context={mutations:d},L(n,t,p,q(p,b=>{t.attributes[h]=b,n.enqueue(d)}),U(n,p,b=>t.attributes[h]=b))}else t.props[h]!=null&&(t.attributes[h]=t.props[h]);if(t.attributes[h]instanceof Promise){let p=!1,b;t.attributes[h].then(g=>{t.attributes[h]=g,p=!0,b?.resolve?.(),n.enqueue(d)}),Object.defineProperty(r,h,{configurable:!1,enumerable:!0,get:a(()=>(n.mutation&&j(d,n.mutation),!p&&n.suspense&&(b=n.suspense.register()),t.attributes[h]),"get"),set:a(g=>{g!==t.attributes[h]&&(t.attributes[h]=g,c[h]=!0,n.enqueue(d))},"set")})}else Object.defineProperty(r,h,{configurable:!1,enumerable:h!=="children",get:a(()=>(n.mutation&&j(d,n.mutation),t.attributes[h]),"get"),set:a(p=>{p!==t.attributes[h]&&(t.attributes[h]=p,c[h]=!0,n.enqueue(d))},"set")})}}i?.safe?.error&&Object.defineProperty(r,"error",{configurable:!1,enumerable:!0,get:a(()=>i.safe.error,"get")});let u=new S(`##${Ct++}`,()=>r.render());if(t.Component===R){let f={type:"Fragment",node:n.createElement("fragment"),children:[]};n.suspense=r;let E=a(()=>{for(let p=0,b=t.children.length;p<b;p++)t.children[p]&&(yt(t.children[p]),z(t.children[p],g=>{g.type===y.Node&&r?.onDisconnect?.();for(let k=0,Et=g.mutations?.length||0;k<Et;k++)g.mutations[k].update=null}));t.children=f.children;for(let p=0,b=t.children.length;p<b;p++)t.children[p].parent=t;let d=st(e,e.children.indexOf(t));for(;f.node.firstChild;)W(t,{node:f.node.firstChild},d)},"replaceChildren"),h=u();if(t instanceof Promise)throw new A("Suspense render cannot be async");v(n,f,O(h),i,s),n.suspense=null,t.mutation=L(n,t,u,()=>_(n,t,null,O(u())),()=>r.fulfilled?E():v(n,t,O(r.render(E)),i,s))}else t.mutation=L(n,t,u,q(u,f=>_(n,t,null,O(f))),U(n,u,f=>v(n,t,O(f),i,s)));return r.onConnect&&It(n,()=>r.onConnect?.()),t.component=r,t}throw new A("Unknown Element type")}a(rt,"renderElement");function _(n,e,t,i){let s=e.context;if(e.type===x)return i[0]!==e.node.textContent&&(e.node.textContent=i[0]),e;if(e.type===y.Node){let r=!1,c=Object.keys(t||{});for(let o=0,l=c.length;o<l;o++){if(!(t[c[o]]instanceof S))continue;let u=e.props[c[o]].context.mutations;L(n,e,e.props[c[o]],q(t[c[o]],f=>{e.attributes[c[o]]=f,n.enqueue(u)}),U(n,t[c[o]],f=>{f!==e.attributes[c[o]]&&(e.attributes[c[o]]=f,r=!0)}))}r&&(i=O(e.mutation()))}else if(e.type!==m){let r=Object.keys(t||{}),c=I(e.props.disabled)||I(e.props.readOnly);for(let o=0,l=r.length;o<l;o++)t[r[o]]instanceof S&&L(n,e,e.props[r[o]],q(t[r[o]],u=>n.setAttribute(e,r[o],u,I(e.props.disabled)||I(e.props.readOnly))),U(n,t[r[o]],u=>{u!==e.attributes[r[o]]&&n.setAttribute(e,r[o],u,c)}))}if(i){let r=[],c=[...e.children];for(let o=0,l=i.length;o<l;o++)r[o]=jt(i[o],o,c);for(let o=0,l=c.length;o<l;o++)c[o]&&(yt(c[o]),z(c[o],u=>{u.type===y.Node&&u.component?.onDisconnect?.();for(let f=0,E=u.mutations?.length||0;f<E;f++)u.mutations[f].update=null}));e.children=[];for(let o=0,l=r.length;o<l;o++){if(!r[o])continue;let u=r[o].type;u==="insert"?e.children[o]=rt(n,e,r[o].element,{...s,components:[...s.components],depth:s.depth+1},st(e,o)):u==="update"&&(e.children[o]=_(n,r[o].element,r[o].props,r[o].children))}}else for(let r=0,c=e.children.length;r<c;r++){if(!e.children[r])continue;let o=e.children[r].type;o===m&&e.children[r].mutation?e.children[r]=_(n,e.children[r],null,O(e.children[r].mutation())):o===y.Node?e.children[r]=_(n,e.children[r]):e.children[r]=_(n,e.children[r],e.children[r].props,e.children[r].children)}return e}a(_,"updateElement");function v(n,e,t,i,s){e.children=[];for(let r=0,c=t.length;r<c;r++)e.children[r]=rt(n,e,t[r],{...i,components:[...i.components],depth:i.depth+1},s)}a(v,"renderElementChildren");function L(n,e,t,i,s){let r=a(()=>{let l=e.context.components;for(let u=0,f=l.length;u<f;u++)j(n.affectedComponents,l[u]);i()},"updateWrapper"),c=e?.context?.safe;e?.context?.profiler?t.update=e.context.profiler.record(c?c.catch(r):r,l=>j(n.profilers,l)):t.update=c?c.catch(r):r;let o=n.mutation;return n.mutation=t,c?c.catch(s)():s(),n.mutation=o,j(e.mutations,t),t}a(L,"applyMutation");function q(n,e){return()=>{let t=n();t instanceof Promise?t.then(e):e(t)}}a(q,"evalMutation");function U(n,e,t){return()=>{let i=e();if(i instanceof Promise){let s=n?.suspense?.register();i.then(()=>{n.enqueue([e]),s?.resolve?.()}),t(null)}else t(i)}}a(U,"evalMutationAsync");function It(n,e){let t=n.mutation;n.mutation=null,e(),n.mutation=t}a(It,"preventMutation");function W(n,e,t){n.type===m||n.type===y.Node?t?(n.firstNode?t===n.firstNode&&(n.firstNode=e.node):n.firstNode=e.node,n.lastNode?t.previousSibling===n.lastNode&&(n.lastNode=e.node):n.lastNode=e.node,W(n.parent,e,t)):(n.firstNode||(n.firstNode=e.node),n.lastNode=e.node,W(n.parent,e)):t?n.node.insertBefore(e.node,t):n.node.appendChild(e.node)}a(W,"appendElement");function yt(n){let e=n.node||n.firstNode,t=a((i,s)=>{for(;i.type===m||i.type===y.Node;)i.firstNode===s?i.firstNode===i.lastNode?(i.firstNode=null,i.lastNode=null):i.firstNode=i.firstNode.nextSibling:i.lastNode===s&&(i.lastNode=i.lastNode.previousSibling),i=i.parent;i.node.removeChild(s)},"remove");if(e){let i=n.lastNode;if(!i||e===i)t(n.parent,e);else{let s=e;for(;s;){let r=s.nextSibling;t(n.parent,s),s===i?s=null:s=r}}}}a(yt,"removeElement");function st(n,e){if(n.type===H||e==null)return null;let t=n.children.length-1;for(let i=1,s=Math.max(e,t-e);i<=s;i++){let r=e+i,c=r<=t&&n.children[r];if(c?.node)return c.node;if(c?.firstNode)return c.firstNode;if(r=e-i,c=r<=t&&n.children[r],c?.node)return c.node.nextSibling;if(c?.lastNode)return c.lastNode.nextSibling}if(n.node)return null;for(let i=0,s=n.parent?.children?.length||0;i<=s;i++)if(n.parent.children[i]===n)return st(n.parent,i);return null}a(st,"findReferenceNode");function jt(n,e,t){if(n==null||n===!1)return null;if(!(n instanceof w))if(Array.isArray(n))n=new w(m,{},n);else if(n instanceof S){let i=t[e];if(i?.mutation&&i?.id===n.id)return{type:"update",element:t.splice(e,1,null)[0],children:O(n())};{let s=t.length-1;for(let r=1,c=Math.max(e,s-e);r<=c;r++){let o=e+r;if(i=o<=s&&t[o],i?.mutation&&i?.id===n.id)return{type:"update",element:t.splice(o,1,null)[0],children:O(n())};if(o=e-r,i=o<=s&&t[o],i?.mutation&&i?.id===n.id)return{type:"update",element:t.splice(o,1,null)[0],children:O(n())}}}return{type:"insert",element:n}}else if(typeof n=="function")n=new w(n);else{if(typeof n=="object"||n instanceof Promise)throw new A(`${it(typeof n)} is not a valid Element`);n=new w(x,null,""+n)}if(n.type===x){let i=t[e];if(i?.type===x)return{type:"update",element:t.splice(e,1,null)[0],children:n.children};{let s=t.length-1;for(let r=1,c=Math.max(e,s-e);r<=c;r++){let o=e+r;if(i=o<=s&&t[o],i?.type===x)return{type:"update",element:t.splice(o,1,null)[0],children:n.children};if(o=e-r,i=o<=s&&t[o],i?.type===x)return{type:"update",element:t.splice(o,1,null)[0],children:n.children}}}return{type:"insert",element:n}}if(typeof n.type=="string"){let i=t[e];if(i?.type===n.type&&i?.id===n.id&&i?.key===n.key)return{type:"update",element:t.splice(e,1,null)[0],props:n.props,children:n.children};{let s=t.length-1;for(let r=1,c=Math.max(e,s-e);r<=c;r++){let o=e+r;if(i=o<=s&&t[o],i?.type===n.type&&i?.id===n.id&&i?.key===n.key)return{type:"update",element:t.splice(o,1,null)[0],props:n.props,children:n.children};if(o=e-r,i=o<=s&&t[o],i?.type===n.type&&i?.id===n.id&&i?.key===n.key)return{type:"update",element:t.splice(o,1,null)[0],props:n.props,children:n.children}}}return{type:"insert",element:n}}if(n.type===m){let i=t[e];if(i?.type===m&&i?.id===n.id)return{type:"update",element:t.splice(e,1,null)[0],children:n.mutation?O(n.mutation()):n.children};{let s=t.length-1;for(let r=1,c=Math.max(e,s-e);r<=c;r++){let o=e+r;if(i=o<=s&&t[o],i?.type===m&&i?.id===n.id)return{type:"update",element:t.splice(o,1,null)[0],children:n.mutation?O(n.mutation()):n.children};if(o=e-r,i=o<=s&&t[o],i?.type===m&&i?.id===n.id)return{type:"update",element:t.splice(o,1,null)[0],children:n.mutation?O(n.mutation()):n.children}}}return{type:"insert",element:n}}if(n.type===y.Node){let i=t[e];if(i?.type===y.Node&&(typeof n.component=="function"?i.component.constructor:i.component)===n.component&&i.id===n.id&&i.key===n.key)return{type:"update",element:t.splice(e,1,null)[0],props:n.props};{let s=t.length-1;for(let r=1,c=Math.max(e,s-e);r<=c;r++){let o=e+r;if(i=o<=s&&t[o],i?.type===y.Node&&(typeof n.component=="function"?i.component.constructor:i.component)===n.component&&i.id===n.id&&i.key===n.key)return{type:"update",element:t.splice(o,1,null)[0],props:n.props};if(o=e-r,i=o<=s&&t[o],i?.type===y.Node&&(typeof n.component=="function"?i.component.constructor:i.component)===n.component&&i.id===n.id&&i.key===n.key)return{type:"update",element:t.splice(o,1,null)[0],props:n.props}}}return{type:"insert",element:n}}}a(jt,"calculateChanges");function pt(){let n={},e=document.activeElement;if(e.tagName==="INPUT"||e.tagName==="TEXTAREA")n.caret={element:e,position:e.selectionStart||0};else{let t=window.getSelection();if(t.rangeCount){let i=t.getRangeAt(0),s=a(o=>o?.nodeType===Node.TEXT_NODE||o?.isContentEditable?s(o.parentElement):o,"getElement"),r=s(i.commonAncestorContainer),c=i.cloneRange();c.selectNodeContents(r),c.setEnd(i.endContainer,i.endOffset),n.caret={element:r,position:c.toString().length}}}return n}a(pt,"createPageSnapshot");function Tt(n){if(n.caret){let{element:e,position:t}=n.caret;if(e.tagName==="INPUT"||e.tagName==="TEXTAREA")e.focus(),e.setSelectionRange(t,t);else{let i=window.getSelection(),s=document.createRange(),r=0;a(function c(o){if(o.nodeType===Node.TEXT_NODE){let l=o.textContent.length;if(r+l>=t)return s.setStart(o,t-r),s.setEnd(o,t-r),!0;r+=l}else if(o.nodeType===Node.ELEMENT_NODE){for(let l of o.childNodes)if(c(l))return!0}return!1},"traverseNodes")(e),i.removeAllRanges(),i.addRange(s)}}}a(Tt,"restorePageSnapshot");function z(n,e){if(n){for(let t=0,i=n?.children?.length||0;t<i;t++)z(n.children[t],e);e(n)}}a(z,"traverseVirtualTree");function I(n){return n instanceof S?n():n}a(I,"getPropValue");var K=class extends B{static{a(this,"Router")}#t={};#e;#i=!1;navigate(e){let t=!this.#i;return this.#i=!0,new Promise(async i=>{let{href:s,pushState:r,refresh:c}=typeof e=="object"?e:{href:e};if(s?.startsWith("#")){document.querySelector(s)?.scrollIntoView({behavior:"smooth"});let{pathname:E,search:h}=window.location;return window.history.replaceState({},"",E+h)}if(!c&&!t&&(c=s===!0),Y(s)||(s=X(typeof s=="string"?s:window.location.pathname)),!Lt(s))return window.location.href=s;let{pathname:o,hash:l,search:u}=new URL(s);if(!c&&!t&&this.#e.pathname===o)return;let f=this.#t?.[o];if(r!==!1&&history.pushState({},"",o+u),this.#e?.disable(),t||c||!f)try{let{default:E,config:h,layout:d,props:p}=await import(`${o}${o.endsWith("/")?"":"/"}page.js`);this.#t[o]=new H(o,document.body,h),gt(()=>{try{this.#e=this.#t[o].render(d?new w(d.component,{},new w(E,p)):new w(E,p)),bt(this.#e.config),l?.startsWith("#")&&wt(()=>document.querySelector(l)?.scrollIntoView({behavior:"smooth"})),window.history.replaceState({},"",o+u),i()}catch(b){console.error(b)}})}catch{window.location.href=s}else gt(()=>{try{this.#e=f.enable(),bt(this.#e.config),l?.startsWith("#")&&wt(()=>document.querySelector(l)?.scrollIntoView({behavior:"smooth"})),window.history.replaceState({},"",o+u),i()}catch(E){console.error(E)}})})}async refresh(e){e||(e=this.#e.pathname),this.#t?.[e]&&delete this.#t[e],e===this.#e.pathname&&await this.navigate({refresh:!0})}async load(){this.#i||(window.addEventListener("click",e=>Mt(e,this)),await this.navigate(),!(!("serviceWorker"in navigator)||!document.querySelector('head > link[rel="manifest"]'))&&navigator.serviceWorker.register(`/${G}/worker.js`).then(void 0,e=>console.log(`Service worker registration failed: ${e}`)))}get location(){return window.page?.location??window.location}emit(e,t){document.body?.dispatchEvent(new CustomEvent(e.toLowerCase(),{bubbles:!0,composed:!0,detail:t}))}on(e,t){document.body?.addEventListener(e,t,!1)}},me=new K;function gt(n){document.startViewTransition||!window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.startViewTransition(n):n()}a(gt,"startViewTransition");function bt(n){let e=Object.keys(n);for(let i=0,s=e.length;i<s;i++)switch(e[i]){case"title":document.title=n.title;break;case"href":document.querySelector("head > base")?.setAttribute("href",n.href);break;case"icon":var t=document.querySelectorAll('head > link[rel$="icon"]');for(let r=0,c=t.length;r<c;r++)t[r].setAttribute("href",n.icon);break;default:document.querySelector(`head > meta[name="${e[i]}"]`)?.setAttribute("content",n[e[i]]);break}}a(bt,"updateConfig");function Mt(n,e){let{tagName:t,href:i,target:s}=n.target;if(t!=="A"||s&&s!=="___private"||!i)return;let r=i.replace(location.origin+"/","");n.preventDefault(),e.navigate(r?.startsWith("#")?r:i)}a(Mt,"handleClick");function Lt(n){return new URL(window.location.href).host===new URL(n).host}a(Lt,"isAppUrl");function wt(n){requestAnimationFrame(()=>setTimeout(n,100))}a(wt,"ensureAnimation");var ot=class extends K{static{a(this,"BuildRouter")}#t=!1;async navigate(e){if(!this.#t)return this.#t=!0,await super.navigate(e);let{href:t}=typeof e=="object"?e:{href:e};Y(t)||(t=X(typeof t=="string"?t:location.pathname)),window.location.href=t}refresh(){location.reload()}},Q=new ot;var D=class extends C{static{a(this,"Theme")}constructor(){super("theme",{value:"auto"},"storage",{toggle:a(e=>{switch(e.value){case"light":return document.documentElement.setAttribute("theme","dark"),{value:"dark"};case"dark":return document.documentElement.removeAttribute("theme"),{value:"auto"};default:return document.documentElement.setAttribute("theme","light"),{value:"light"}}},"toggle"),set:a((e,t)=>(document.documentElement.setAttribute("theme",t),{value:t}),"set")}),document.documentElement.setAttribute("theme",this.value?.value)}};T(window,"vistta",{Fragment:m,Element:w,Context:C,Ref:M,Component:y,Suspense:R,Profiler:P,Render:ht,Safe:F,Form:$,router:Q,socket:{emit(){console.warn("Socket is not available on built apps.")},on(){console.warn("Socket is not available on built apps.")}},Theme:D});window.addEventListener("popstate",()=>Q.navigate({pushState:!1}));window.addEventListener("load",()=>Q.load());
