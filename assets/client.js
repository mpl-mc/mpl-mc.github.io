var Et=Object.defineProperty;var a=(n,e)=>Et(n,"name",{value:e,configurable:!0});function ct(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}a(ct,"camelCaseToKebabCase");function k(n){return Array.isArray(n)?n:[n]}a(k,"ensureArray");function I(n,e){for(let t=0,i=n.length;t<i;t++)if(n[t]===e)return;n.push(e)}a(I,"addUnique");var B=class{static{a(this,"BoundClass")}constructor(){let e=Object.getPrototypeOf(this),t=Object.getOwnPropertyNames(e);for(let i=0,s=t.length;i<s;i++){if(t[i]==="constructor")continue;let r=Object.getOwnPropertyDescriptor(e,t[i]);typeof r.get>"u"&&typeof r.set>"u"&&(this[t[i]]=this[t[i]].bind(this))}}};function tt(n,e=!1){return JSON.stringify(n,Nt(),e?e===!0?4:e:null)}a(tt,"stringify");function et(n,e=!1){if(!e)return JSON.parse(n);try{return JSON.parse(n)}catch{return{}}}a(et,"parse");function nt(n,e){return e?et(tt(n)):structuredClone(n)}a(nt,"clone");function Nt(n=new WeakSet){return function(e,t){if(typeof t=="object"&&t!==null){if(n.has(t))return;n.add(t)}return t}}a(Nt,"duplicateReplacer");function at(n){return n instanceof Promise}a(at,"isPromise");async function it(n){return typeof n=="function"?await new Promise((e,t)=>n(e,t)):n instanceof Promise?await n:n}a(it,"async");var E=a((n,{method:e="get",controller:t,headers:i,params:s,timeout:r,content:c,...o}={})=>{t||(t=new AbortController);let{body:u,contentType:d}=St(o?.body),l=new Promise(async(p,x)=>{i=await xt(n,i,d,e),s&&(s=new URLSearchParams(s)),r=r?setTimeout(()=>t.abort(),r):void 0;try{let f=await fetch(s?`${n}?${s.toString()}`:n,{...o,headers:i,body:u,method:e?.toUpperCase(),signal:t.signal});return f.ok?p({data:await f[c||mt(f.headers.get("content-type"))](),status:f.status,statusText:f.statusText,headers:f.headers}):x(new Error(await f.text()||f.status+""+f.statusText))}catch(f){if(!t.signal.aborted)return x(f)}finally{clearTimeout(r)}});return l.abort=()=>t.abort(),l},"request");E.get=(n,e)=>E(n,{method:"get",...e});E.post=(n,e)=>E(n,{method:"post",...e});E.head=(n,e)=>E(n,{method:"head",...e});E.put=(n,e)=>E(n,{method:"put",...e});E.delete=(n,e)=>E(n,{method:"delete",...e});E.connect=(n,e)=>E(n,{method:"connect",...e});E.options=(n,e)=>E(n,{method:"options",...e});E.trace=(n,e)=>E(n,{method:"trace",...e});E.patch=(n,e)=>E(n,{method:"patch",...e});function St(n){return n instanceof FormData?{body:n,contentType:"auto"}:{body:JSON.stringify(n),contentType:"default"}}a(St,"transformBody");async function xt(n,e,t,i){return e instanceof Headers||(e=new Headers(typeof e=="object"?e:{})),e.append("accept","application/json, text/plain, */*"),e.append("path",n),e.append("method",i||"GET"),e.append("sec-fetch-mode","cors"),e.append("sec-fetch-site","same-origin"),t!=="auto"&&!e.get("Content-Type")&&e.append("Content-Type",t!=="default"?t:"application/json"),e}a(xt,"buildHeaders");function mt(n){return typeof n!="string"?"blob":n.includes("application/json")?"json":n.includes("application/octet-stream")?"arrayBuffer":n.includes("multipart/form-data")?"formData":n.includes("text/")?"text":"blob"}a(mt,"convertResponse");function J(n,e="base64"){if(typeof Buffer<"u")return Buffer.from(n).toString(e);let t="";switch(e){case"base64":t=btoa(n);break;case"hex":for(let i=0,s=n.length;i<s;i++)t+=n[i].charCodeAt(0).toString(16).padStart(2,"0");break;case"ascii":case"binary":default:throw new Error("Not ready for this encoding")}return t}a(J,"encode");function ft(n,e="base64"){if(typeof Buffer<"u")return Buffer.from(n,e).toString();let t="";switch(e){case"base64":t=atob(n);break;case"hex":var i=n.match(/.{1,2}/g)||[];for(let s=0,r=i.length;s<r;s++)t+=String.fromCharCode(parseInt(i[s],16));break;case"ascii":case"binary":default:throw new Error("Not ready for this encoding")}return t}a(ft,"decode");function ut(n){return n.charAt(0).toUpperCase()+n.slice(1)}a(ut,"capitalize");function Y(n){try{return!!new URL(n)}catch{return!1}}a(Y,"isValidUrl");var G="assets",j=a((n,e,t)=>Object.defineProperty(n,e,{value:t,writable:!1,configurable:!1}),"defineReadonly");var W=class extends Function{static{a(this,"FunctionClass")}constructor(e){return Object.setPrototypeOf(e,new.target.prototype)}};var lt="Vistta_Context_",O=Symbol("Fragment"),Z=Symbol("TextNode"),Ot=Symbol("Component"),N=class n{static{a(this,"Element")}constructor(e,t,...i){this.props=t||{},this.children=i;let s=typeof e;if(e?.prototype instanceof b||s==="function")this.type=b.Node,this.props.children=i,this.Component=e;else{if(s!=="string"&&s!=="symbol")return null;t?.ref!=null&&(t.ref instanceof S&&(t.ref=t.ref()),this.ref=t.ref,delete this.props.ref),this.type=e}t?.key!=null&&(t.key instanceof S&&(t.key=t.key()),typeof t.key=="number"?this.key=""+t?.key:this.key=t?.key,delete this.props.key)}toString(){let e=this.children?.reduce((s,r)=>s+r,"");if(typeof this.type!="string")return e;let t="",i=Object.keys(this.props||{});for(let s=0,r=i.length;s<r;s++){let c=i[s],o=c==="style"?kt(this.props[c]):this.props[c];o==null||o===!1||["function","object"].includes(typeof o)||(o===!0?t+=` ${c}`:t+=` ${c}="${o}"`)}return`<${this.type}${t}>${e}</${this.type}>`}clone(e,t){if(e!==!1)if(e){let{style:i,...s}=e||{};e=Object.assign(ht(this.props),s),e.style=Object.assign(e.style||{},i||{})}else e=ht(this.props);return t!==!1&&(t=this?.children?.map(i=>i instanceof n?i.clone(void 0,!0):i)),new n(this.type,e,t)}},S=class extends W{static{a(this,"Mutation")}constructor(e,t){super(t),this.id=e,this.callback=t}},A=class extends W{static{a(this,"Context")}#t;#e;#i;#n;#o;#c=[];constructor(e,t,i,s,r){if(typeof e!="string"||e.length==0)throw new Error("TypeError: Invalid context key.");if(typeof t!="object")throw new Error("TypeError: Cannot create context with a non-object value.");super(()=>this),this.#t=e;try{this.#e=nt(t)}catch{throw new Error("TypeError: Cannot create context with a non serializable object as default value.")}if(this.#i=i==="session"?sessionStorage:i==="local"||i==="storage"?localStorage:null,this.#i)try{this.#e=et(ft(this.#i.getItem(J(lt+e,"hex")),"hex"))??this.#e}catch{}let c=Object.keys(s||{});if(c.length>0){let o=a((u,d)=>{let l=typeof r;l==="function"?r.call(this,u,d,this.value):l==="object"&&r?.[u]?.call(this,d,this.value)},"controllerFn");for(let u=0,d=c.length;u<d;u++){let l=c[u];if(["valueOf","toString","setValue","register","proxy"].includes(l))throw new Error(`Invalid action name "${l}".`);let p=s[l];this[l]=((...x)=>{o(l,"pending");let f=new AbortController,y=new Promise(h=>{f.signal.onabort=()=>{o(l,"rejected"),h()};try{let g=p(nt(this.#e),...x);at(g)?g.then(w=>{f.signal?.aborted||(Object.assign(this.proxy(),w),h(),o(l,"completed"))}).catch(()=>{o(l,"rejected"),h()}):f.signal?.aborted||(Object.assign(this.proxy(),g),h(),o(l,"completed"))}catch(g){throw o(l,"rejected"),g}});return y.abort=(...h)=>f.abort(...h),y}).bind(this)}}}get key(){return this.#t}get value(){return this.#n||(this.#n=new Proxy(this.#e,{set:a(()=>!0,"set"),deleteProperty:a(()=>!0,"deleteProperty"),defineProperty:a(()=>!0,"defineProperty")})),this.#n}valueOf(){return this.value}toString(){return JSON.stringify(this.#e)}proxy(e){let t=this.#c;if(typeof e?.set=="function"&&t.push(e.set),this.#o)return this.#o;let i=a(()=>{if(this.#i)try{this.#i.setItem(J(lt+this.#t,"hex"),J(tt(this.#e),"hex"))}catch(s){console.error(s)}},"updateCache");return this.#o=new Proxy(this.#e,{get(s,r){return typeof e?.get=="function"&&e.get(this.path?`${this.path}.${r}`:r,s[r]),s[r]},set(s,r,c){if(s[r]===c||JSON.stringify(s[r])===JSON.stringify(c))return!0;s[r]=c;for(let o=0,u=t.length;o<u;o++)t[o](this.path?`${this.path}.${r}`:r,c);return i(),!0}}),this.#o}},T=class{static{a(this,"Ref")}constructor(e){this.node=e}},b=class{static{a(this,"Component")}children=[];static get Node(){return Ot}get props(){let e={},t=Object.keys(this);for(let i=0,s=t.length;i<s;i++){let r=t[i];r==="render"||r==="children"||(e[r]={get:a(()=>this[r],"get"),set:a(c=>this[r]=c,"set")})}return e}constructor(){let e=Object.getPrototypeOf(this),t=Object.getOwnPropertyNames(e);for(let i=0,s=t.length;i<s;i++){if(t[i]==="constructor")continue;let r=Object.getOwnPropertyDescriptor(e,t[i]);typeof r.get>"u"&&typeof r.set>"u"&&(this[t[i]]=this[t[i]].bind(this))}}},M=class extends b{static{a(this,"Suspense")}#t=0;#e;get fulfilled(){return this.#t==0}register(){return this.#t++,console.log("register",this.#t),this}resolve(){this.#t--,console.log("resolve",this.#t),this.#t==0&&this.#e(!0)}render(e){return e&&(this.#e=e),this.#t==0?this.children:this.fallback}},_=class extends b{static{a(this,"Profiler")}callback;#t;#e=0;onConnect(){this.callback(performance.now()-this.#t)}render(){return this.callback,this.children;return this.#t=performance.now(),this.children}record(e,t){return()=>{let i=performance.now();e(),this.#e=performance.now()-i,t(this)}}end(){let e=this.#e;this.#e=0,this.callback(e)}},dt={If:class extends b{static{a(this,"If")}condition;render(){return this.condition&&this.children}},Each:class extends b{static{a(this,"Each")}of;as;render(){if(typeof this.of!="object"||typeof this.as!="function")return null;let n=[];if(Array.isArray(this.of))for(let e=0,t=this.of.length;e<t;e++)n.push(this.as(this.of[e],e));else{let e=Object.keys(this.of);for(let t=0,i=e.length;t<i;t++)n.push(this.as(this.of[e[t]],e[t]))}return n}}},v=class extends b{static{a(this,"Safe")}error;fallback;catch(e){return()=>{try{e()}catch(t){console.error(t),this.error=t}}}render(){return this.error?this.fallback:this.children}},R=class n extends b{static{a(this,"Form")}static Ref=T;static get DEFAULT_ERROR_MESSAGE(){if(!this._defaultErrorMessage){let e=document.createElement("input");e.type="text",e.required=!0,this._defaultErrorMessage=e.validationMessage}return this._defaultErrorMessage}#t;#e=[];#i;#n={};#o={};#c={};#a={};#r={};#s;ref;id;name;className;autocomplete;style;onsubmit;onSubmit;oninvalid;onInvalid;get path(){return this.#e}onConnect(){this.#i||!this.ref||this.ref.node||Object.assign(this.ref,{node:this.#t,watch:a((...e)=>this.watch(...e),"watch"),unwatch:a((...e)=>this.unwatch(...e),"unwatch"),reset:a(e=>this.reset(e),"reset"),clear:a(e=>this.clear(e),"clear"),submit:a(()=>this.submit(),"submit"),values:a(()=>this.values(),"values"),validate:a(e=>this.validate(e),"validate")})}render(){return this.#i?this.name?this.className||this.style?new N("div",{className:this.className,style:this.style},...this.children):new N(O,{},...this.children):null:(this.#s=typeof this.oninvalid=="function"||typeof this.onInvalid=="function",new N("form",{ref:a(e=>this.#t=e,"ref"),className:this.className,autocomplete:this.autocomplete,onreset:a(()=>this.reset(),"onreset"),oninvalid:this.oninvalid||this.onInvalid,onsubmit:a(e=>{e.preventDefault(),this.validate()&&(e.values=this.values(),typeof this.onsubmit=="function"?this.onsubmit?.(e):typeof this.onSubmit=="function"&&this.onSubmit?.(e))},"onsubmit"),style:this.style},...this.children))}register(e){if(e instanceof n){this.#i=e,this.#e=[...this.#i.path,this.name||this.id];return}let{type:t,attributes:i,node:s}=e||{};if(!s||t!=="input"&&t!=="textarea"&&t!=="select"&&i.role!=="input"||i.type==="submit")return;let r=i.name||i.id;if(r){if(i.type==="radio"?(this.#n[r]||(this.fields[r]=[]),this.#n[r].push(s)):this.#n[r]=s,this.#o[r]=X(s),this.#i)return this.#i.register({type:t,props:{name:[...this.path,r].join("."),...i},node:s});this.#c[r]=i.required,this.#a[r]=i.validator instanceof S?i.validator():i.validator,s.addEventListener(t==="select"?"change":"input",c=>{this.#s||s.setCustomValidity?.("");for(let o=0,u=this.#r[r]?.length;o<u;o++)this.#r[r][o](c);for(let o=0,u=this.#r["*"]?.length;o<u;o++)this.#r["*"][o](c)})}}watch(...e){if(e.length==0||this.#i)return;e.length==1&&e.unshift("*");let[t,i]=e;if(!this.#r[t]){this.#r[t]=[i];return}for(let s=0,r=this.#r[t]?.length;s<r;s++)if(this.#r[t][s]===i)return;this.#r[t].push(i)}unwatch(...e){if(e.length==0||this.#i)return;e.length==1&&e.unshift("*");let[t,i]=e;for(let s=0,r=this.#r[t]?.length;s<r;s++)if(this.#r[t][s]===i){this.#r[t].splice(s,1);return}}reset(e="*"){if(e==="*"){let s=Object.keys(this.#n);for(let r=0,c=s.length;r<c;r++){let o=this.#n[s[r]],u=this.#o[s[r]];o.value!==u&&(o.value=u,o.dispatchEvent(new Event(o.localName==="select"?"change":"input")),this.#s||o.setCustomValidity?.(""))}return}let t=this.#n[e],i=this.#o[e];t.value!==i&&(t.value=i,t.dispatchEvent(new Event(t.localName==="select"?"change":"input")),this.#s||t.setCustomValidity?.(""))}validate(e){if(e&&!this.#n[e])return null;let t=[],i=e?[e]:Object.keys(this.#n);for(let r=0,c=i.length;r<c;r++){let o=this.#n[i[r]],u=X(o);if(this.#c[i[r]]===!0&&!u){this.#s?t.push({field:o,error:n.DEFAULT_ERROR_MESSAGE}):o.setCustomValidity?.(n.DEFAULT_ERROR_MESSAGE);continue}let d=this.#a[i[r]],l=typeof d=="function"?d(u):null;typeof l=="string"?this.#s?t.push({field:o,error:l}):o.setCustomValidity?.(l):l===!1?this.#s?t.push({field:o,error:n.DEFAULT_ERROR_MESSAGE}):o.setCustomValidity?.(n.DEFAULT_ERROR_MESSAGE):this.#s||o.setCustomValidity?.("")}if(!this.#s)return this.#t.reportValidity();if(t.length===0)return!0;let s=new Event("invalid");return s.errors=t,this.#t.dispatchEvent(s),!1}clear(e="*"){if(e==="*"){let i=Object.keys(this.#n);for(let s=0,r=i.length;s<r;s++){let c=this.#n[i[s]];c.value!==""&&(c.value="",c.dispatchEvent(new Event(c.localName==="select"?"change":"input")))}return}let t=this.#n[e];t.value!==""&&(t.value="",t.dispatchEvent(new Event(t.localName==="select"?"change":"input")))}submit(){this.#t.requestSubmit()}values(){let e={},t=Object.keys(this.#n);for(let i=0,s=t.length;i<s;i++){let r=t[i];if(r.includes(".")){let c=e,o=r.split(".");for(let u=0,d=o.length;u<d;u++){let l=o[u];u===d-1?c[l]=X(this.#n[r]):(c[l]=c[l]||{},c=c[l])}}else e[r]=X(this.#n[r])}return e}};j(window,"Fragment",O);j(window,"prop",(n,e)=>new S(n,e));j(window,"child",(n,e)=>new S(n,e));j(window,"element",(n,...e)=>{let t=new N(...e);return t.id=n,t});function ht(n){let e=a(t=>{if(typeof t=="object")if(Array.isArray(t)){let i=[];for(let s=0,r=t.length;s<r;s++)i[s]=e(t[s]);return i}else{let i={},s=Object.keys(t||{});for(let r=0,c=s.length;r<c;r++)i[s[r]]=e(t[s[r]]);return i}else return t},"clone");return e(n)}a(ht,"cloneProps");function kt(n){let e=Object.keys(n||{}),t="";for(let i=0,s=e.length;i<s;i++){let r=n[e[i]];typeof r=="string"&&(t+=` ${ct(e[i])}: ${r};`)}return t=t.trim(),t===""?null:t}a(kt,"styleToString");function X(n){if(Array.isArray(n)){for(let e=0,t=n.length;e<t;e++)if(n[e].checked)return n[e].value;return null}return n.type==="checkbox"?n.checked:n.value}a(X,"getFieldValue");var pt=new Error("Event strict mode active"),At=0,m=class extends Error{static{a(this,"VirtualDomError")}constructor(e){super(e),this.name="Virtual Dom Error"}},U=class n{static{a(this,"VirtualDom")}active=!1;running=!1;queue=[];keys={};affectedComponents=[];profilers=[];styleSheets={};constructor(e,t,i){this.pathname=e,this.host=t,this.config=i}createElement(e){return e==="fragment"?document.createDocumentFragment():document.createElement(e)}createTextNode(e){return document.createTextNode(e)}setAttribute(e,t,i,s){if(t==="validator"&&typeof i=="function"||e.attributes[t]===i)return;e.attributes[t]=i;let r=e.node;if(!s&&/^on\w.*/.test(t)&&typeof i=="function"){r[t.toLowerCase()]=(c,...o)=>{try{c.stritMode=()=>{if(c.target!==r)throw pt},i(c,...o)}catch(u){if(u!==pt)throw u}};return}if(t==="className"&&(t="class"),i==null||i===!1)r.removeAttribute(t);else if(t==="value")r.value=i;else if(t==="style"&&typeof i=="object"){let c=Object.keys(i);for(let o=0,u=c.length||0;o<u;o++)r.style.setProperty(c[o],i[c[o]])}else r.setAttribute(t,typeof i=="boolean"?"":i);t.startsWith("style-")&&i&&this.addStyleSheet(t.replace("style-",""),!0),t==="id"&&i&&r.style.setProperty("anchor-name",`--a_${i.toLowerCase()}`),t==="anchor"&&r.style.setProperty("position-anchor",`--a_${i.toLowerCase()}`)}render(e){this.active=!0,this.running=!0;let t={type:n,node:this.createElement("fragment")};this.virtualTree=rt(this,t,e,{depth:0,components:[]});for(let i=0,s=this.config?.styles?.length||0;i<s;i++)this.addStyleSheet(Object.keys(this.config.styles[i])[0].replace("style-",""));return this.replaceStyleSheets(),this.host.replaceChildren(t.node),t.node=this.host,this.snapshot=yt(),requestAnimationFrame(()=>this.update()),this}enqueue(e){if(!Array.isArray(e))throw new m("Internal Error #001");this.queue.push(...e),!(!this.active||this.running)&&(this.running=!0,this.snapshot=yt(),requestAnimationFrame(()=>this.update()))}update(){let e=performance.now();for(;this.queue.length>0;)if(this.queue.shift().update?.(),performance.now()-e>16)return requestAnimationFrame(()=>this.update());let t=this.affectedComponents;this.affectedComponents=[];for(let s=0,r=t.length;s<r;s++)t[s].onUpdate?.();let i=this.profilers;this.profilers=[];for(let s=0,r=i.length;s<r;s++)i[s].end();It(this.snapshot),this.running=!1}disable(){if(!this.virtualTree)throw new m("Virtual Dom not rendered");V(this.virtualTree,e=>{e.type===b.Node&&e.component?.onDisconnect?.()}),this.active=!1,this.running=!1}enable(){if(!this.virtualTree)throw new m("Virtual Dom not rendered");this.active=!0,this.running=!0,V(this.virtualTree,i=>{i.type===b.Node&&i.component?.onConnect?.()});let e=this.createElement("fragment"),t=this.virtualTree.node||this.virtualTree.firstNode;if(t){let i=this.virtualTree.lastNode;if(!i||t===i)e.appendChild(t);else{let s=t;for(;s;){let r=s.nextSibling;e.appendChild(s),s===i?s=null:s=r}}}return this.replaceStyleSheets(),this.host.replaceChildren(e),this.next(),this}addStyleSheet(e,t){if(e=`/${G}/${e}${t?".scoped":""}.css`,this.styleSheets[e])return;let i=document.querySelector(`link[rel="stylesheet"][href="${e}"]`);i||(i=document.createElement("link"),i.rel="stylesheet",i.href=e,document.head.appendChild(i)),this.styleSheets[e]=i}replaceStyleSheets(){let e=document.head.querySelectorAll('link[rel="stylesheet"]'),t={};for(let s=0,r=e.length;s<r;s++){let c=e[s],o=c.href.replace(c.baseURI,"/");t[o]=!0,!this.styleSheets[o]&&c.remove()}let i=Object.keys(this.styleSheets);for(let s=0,r=i.length;s<r;s++)t[i[s]]||document.head.appendChild(this.styleSheets[i[s]])}};function rt(n,e,t,i,s){if(t==null||t===!1)return null;if(t instanceof N){if(t.type==null)return null}else if(Array.isArray(t))t=new N(O,null,t);else if(t instanceof S){let r=t;t=new N(O),t.id=r.id,t.mutations=[],t.mutation=L(n,t,r,F(r,c=>q(n,t,null,k(c))),P(n,r,c=>t.children=k(c)))}else if(typeof t=="function")t=new N(t);else{if(typeof t=="object"||t instanceof Promise)throw new m(`${ut(typeof t)} is not a valid Element`);t=new N(Z,null,""+t)}if(t.mutations=[],t.parent=e,t.context=i,t.type===Z)return t.node=n.createTextNode(t.children[0]),$(e,t,s),t;if(typeof t.type=="string"){if(t.key?.length>0){if(t.key instanceof S)throw new m("Internal Error #002");if(n.keys[t.key]==null)n.keys[t.key]={type:t.type,node:n.createElement(t.type)};else if(n.keys[t.key].type!==t.type)throw new m(`Key ${t.key} already in use.`);t.node=n.keys[t.key].node}else t.node=n.createElement(t.type);if(t.ref instanceof S)throw new m("Internal Error #003");typeof t.ref=="function"?t.ref(t.node):t.ref instanceof T&&(t.ref.node=t.node),t.node._element=t,t.attributes={};let r=Object.keys(t.props),c=C(t.props.disabled)||C(t.props.readOnly);for(let o=0,u=r.length;o<u;o++){let d=t.props[r[o]];d instanceof S?L(n,t,d,F(d,l=>n.setAttribute(t,r[o],l,C(t.props.disabled)||C(t.props.readOnly))),P(n,d,l=>n.setAttribute(t,r[o],l,c))):n.setAttribute(t,r[o],d,c)}return H(n,t,t.children,i),$(e,t,s),i.form?.register(t),t}if(t.type===O)return H(n,t,t.children,i,s),t;if(t.type===b.Node){let r,c=t.key?.length>0;if(c){if(t.key instanceof S)throw new m("Internal Error #002");if(n.keys[t.key]!=null){if(n.keys[t.key].type!==t.Component)throw new m(`Key ${t.key} already in use.`);let p=n.keys[t.key].element;p.parent=e;let x=a(f=>{for(let y=0,h=f.children.length;y<h;y++){let g=f.children[y];g.node?$(g.parent,g,s):x(g)}},"appendChildren");return x(p),V(p,f=>f.type===b.Node&&f.component?.onConnect?.()),{...p,...t}}}if(t.Component.prototype instanceof b)r=new t.Component;else{if(r=t.Component(),typeof r!="object"||typeof r.render!="function")throw new m("Invalid Function Component format");r=Object.assign(new b,r)}c&&(n.keys[t.key]={type:t.Component,element:t}),i.components.push(r),t.attributes={};let o={};t.Component===R?i.form?r.register(i.form):i.form=r:(t.Component,_,t.component===v&&(i.safe=r));let u=Object.keys(t.props);for(let p=0,x=u.length;p<x;p++)r[u[p]]??=!0;let d=Object.getOwnPropertyNames(r);for(let p=0,x=d.length;p<x;p++){let f=d[p];if(f==="render"||f==="onConnect"||f==="onDisconnect")Object.defineProperty(r,f,{configurable:!1,enumerable:!1,value:r[f].bind(r)});else if(f==="onUpdate"){let y=r.onUpdate;Object.defineProperty(r,"onUpdate",{configurable:!1,enumerable:!1,value:a(()=>(y.call(r,o),o={}),"value")})}else if(r[f]instanceof A){let y=r[f];if(!i["#"+y.key]){let h={},g={};i["#"+y.key]=y.proxy({get:a((w,z)=>{h[w]||(h[w]=[]),n.mutation&&(I(h[w],n.mutation),g[w]=z)},"get"),set:a((w,z)=>{g[w]!=z&&(g[w]=z,o[f]=!0,h[w]&&n.enqueue(h[w]))},"set")})}Object.defineProperty(r,f,{configurable:!1,enumerable:!1,get:a(()=>i["#"+y.key],"get")})}else{let y=[];if(t.attributes[f]=r[f],t.props[f]instanceof S){let h=t.props[f];h.context={mutations:y},L(n,t,h,F(h,g=>{t.attributes[f]=g,n.enqueue(y)}),P(n,h,g=>t.attributes[f]=g))}else t.props[f]!=null&&(t.attributes[f]=t.props[f]);if(t.attributes[f]instanceof Promise){let h=!1,g;t.attributes[f].then(w=>{t.attributes[f]=w,h=!0,g?.resolve?.(),n.enqueue(y)}),Object.defineProperty(r,f,{configurable:!1,enumerable:!0,get:a(()=>(n.mutation&&I(y,n.mutation),!h&&n.suspense&&(g=n.suspense.register()),t.attributes[f]),"get"),set:a(w=>{w!==t.attributes[f]&&(t.attributes[f]=w,o[f]=!0,n.enqueue(y))},"set")})}else Object.defineProperty(r,f,{configurable:!1,enumerable:f!=="children",get:a(()=>(n.mutation&&I(y,n.mutation),t.attributes[f]),"get"),set:a(h=>{h!==t.attributes[f]&&(t.attributes[f]=h,o[f]=!0,n.enqueue(y))},"set")})}}i?.safe?.error&&Object.defineProperty(r,"error",{configurable:!1,enumerable:!0,get:a(()=>i.safe.error,"get")});let l=new S(`##${At++}`,()=>r.render());if(t.Component===M){let p={type:"Fragment",node:n.createElement("fragment"),children:[]};n.suspense=r;let x=a(()=>{for(let h=0,g=t.children.length;h<g;h++)t.children[h]&&(gt(t.children[h]),V(t.children[h],w=>w.type===b.Node&&r?.onDisconnect?.()));t.children=p.children;for(let h=0,g=t.children.length;h<g;h++)t.children[h].parent=t;let y=st(e,e.children.indexOf(t));for(;p.node.firstChild;)$(t,{node:p.node.firstChild},y)},"replaceChildren"),f=l();if(t instanceof Promise)throw new m("Suspense render cannot be async");H(n,p,k(f),i,s),n.suspense=null,t.mutation=L(n,t,l,()=>q(n,t,null,k(l())),()=>r.fulfilled?x():H(n,t,k(r.render(x)),i,s))}else t.mutation=L(n,t,l,F(l,p=>q(n,t,null,k(p))),P(n,l,p=>H(n,t,k(p),i,s)));return r.onConnect&&Ct(n,()=>r.onConnect?.()),t.component=r,t}throw new m("Unknown Element type")}a(rt,"renderElement");function q(n,e,t,i){let s=e.context;if(e.type===Z)return i[0]!==e.node.textContent&&(e.node.textContent=i[0]),e;if(e.type===b.Node){let r=!1,c=Object.keys(t||{});for(let o=0,u=c.length;o<u;o++){if(!(t[c[o]]instanceof S))continue;let d=e.props[c[o]].context.mutations;L(n,e,e.props[c[o]],F(t[c[o]],l=>{e.attributes[c[o]]=l,n.enqueue(d)}),P(n,t[c[o]],l=>{l!==e.attributes[c[o]]&&(e.attributes[c[o]]=l,r=!0)}))}r&&(i=k(e.mutation()))}else if(e.type!==O){let r=Object.keys(t||{}),c=C(e.props.disabled)||C(e.props.readOnly);for(let o=0,u=r.length;o<u;o++)t[r[o]]instanceof S&&L(n,e,e.props[r[o]],F(t[r[o]],d=>n.setAttribute(e,r[o],d,C(e.props.disabled)||C(e.props.readOnly))),P(n,t[r[o]],d=>{d!==e.attributes[r[o]]&&n.setAttribute(e,r[o],d,c)}))}if(i){for(let r=0,c=e.children.length;r<c;r++)e.children[r]&&(gt(e.children[r]),V(e.children[r],o=>o.type===b.Node&&o.component?.onDisconnect?.()));e.children=[];for(let r=0,c=i.length;r<c;r++)e.children[r]=rt(n,e,i[r],{...s,components:[...s.components],depth:s.depth+1},st(e,r))}else for(let r=0,c=e.children.length;r<c;r++){if(!e.children[r])continue;let o=e.children[r].type;o===O&&e.children[r].mutation?e.children[r]=q(n,e.children[r],null,k(e.children[r].mutation())):o===b.Node?e.children[r]=q(n,e.children[r]):e.children[r]=q(n,e.children[r],e.children[r].props,e.children[r].children)}return e}a(q,"updateElement");function H(n,e,t,i,s){e.children=[];for(let r=0,c=t.length;r<c;r++)e.children[r]=rt(n,e,t[r],{...i,components:[...i.components],depth:i.depth+1},s)}a(H,"renderElementChildren");function L(n,e,t,i,s){let r=a(()=>{let u=e.context.components;for(let d=0,l=u.length;d<l;d++)I(n.affectedComponents,u[d]);i()},"updateWrapper"),c=e?.context?.safe;e?.context?.profiler?t.update=e.context.profiler.record(c?c.catch(r):r,u=>I(n.profilers,u)):t.update=c?c.catch(r):r;let o=n.mutation;return n.mutation=t,c?c.catch(s)():s(),n.mutation=o,I(e.mutations,t),t}a(L,"applyMutation");function F(n,e){return()=>{let t=n();t instanceof Promise?t.then(e):e(t)}}a(F,"evalMutation");function P(n,e,t){return()=>{let i=e();if(i instanceof Promise){let s=n?.suspense?.register();i.then(()=>{n.enqueue([e]),s?.resolve?.()}),t(null)}else t(i)}}a(P,"evalMutationAsync");function Ct(n,e){let t=n.mutation;n.mutation=null,e(),n.mutation=t}a(Ct,"preventMutation");function $(n,e,t){n.type===O||n.type===b.Node?t?(n.firstNode?t===n.firstNode&&(n.firstNode=e.node):n.firstNode=e.node,n.lastNode?t.previousSibling===n.lastNode&&(n.lastNode=e.node):n.lastNode=e.node,$(n.parent,e,t)):(n.firstNode||(n.firstNode=e.node),n.lastNode=e.node,$(n.parent,e)):t?n.node.insertBefore(e.node,t):n.node.appendChild(e.node)}a($,"appendElement");function gt(n){let e=n.node||n.firstNode,t=a((i,s)=>{for(;i.type===O||i.type===b.Node;)i.firstNode===s?i.firstNode===i.lastNode?(i.firstNode=null,i.lastNode=null):i.firstNode=i.firstNode.nextSibling:i.lastNode===s&&(i.lastNode=i.lastNode.previousSibling),i=i.parent;i.node.removeChild(s)},"remove");if(e){let i=n.lastNode;if(!i||e===i)t(n.parent,e);else{let s=e;for(;s;){let r=s.nextSibling;t(n.parent,s),s===i?s=null:s=r}}}}a(gt,"removeElement");function st(n,e){if(n.type===U||e==null)return null;let t=n.children.length-1;for(let i=1,s=Math.max(e,t-e);i<=s;i++){let r=e+i,c=r<=t&&n.children[r];if(c?.node)return c.node;if(c?.firstNode)return c.firstNode;if(r=e-i,c=r<=t&&n.children[r],c?.node)return c.node.nextSibling;if(c?.lastNode)return c.lastNode.nextSibling}if(n.node||n.parent.type===U)return null;for(let i=0,s=n.parent?.children?.length||0;i<s;i++)if(n.parent.children[i]===n)return st(n.parent,i);return null}a(st,"findReferenceNode");function yt(){let n={},e=document.activeElement;if(e.tagName==="INPUT"||e.tagName==="TEXTAREA")n.caret={element:e,position:e.selectionStart||0};else{let t=window.getSelection();if(t.rangeCount){let i=t.getRangeAt(0),s=a(o=>o?.nodeType===Node.TEXT_NODE||o?.isContentEditable?s(o.parentElement):o,"getElement"),r=s(i.commonAncestorContainer),c=i.cloneRange();c.selectNodeContents(r),c.setEnd(i.endContainer,i.endOffset),n.caret={element:r,position:c.toString().length}}}return n}a(yt,"createPageSnapshot");function It(n){if(n.caret){let{element:e,position:t}=n.caret;if(e.tagName==="INPUT"||e.tagName==="TEXTAREA")e.focus(),e.setSelectionRange(t,t);else{let i=window.getSelection(),s=document.createRange(),r=0;a(function c(o){if(o.nodeType===Node.TEXT_NODE){let u=o.textContent.length;if(r+u>=t)return s.setStart(o,t-r),s.setEnd(o,t-r),!0;r+=u}else if(o.nodeType===Node.ELEMENT_NODE){for(let u of o.childNodes)if(c(u))return!0}return!1},"traverseNodes")(e),i.removeAllRanges(),i.addRange(s)}}}a(It,"restorePageSnapshot");function V(n,e){if(n){for(let t=0,i=n?.children?.length||0;t<i;t++)V(n.children[t],e);e(n)}}a(V,"traverseVirtualTree");function C(n){return n instanceof S?n():n}a(C,"getPropValue");var K=class extends B{static{a(this,"Router")}#t={};#e;#i=!1;#n=null;async navigate(e){let t=!this.#i;this.#i=!0;let{href:i,pushState:s,refresh:r}=typeof e=="object"?e:{href:e};!r&&!t&&(r=i===!0);let c=s!==!1?l=>history.pushState({},"",l):l=>history.replaceState({},"",l);if(Y(i)&&!Tt(i))return window.location.href=i;let{pathname:o,hash:u,search:d}=i?new URL(i,window.location.href):new URL(window.location.href);if(!(this.#n?.pathname===o&&this.#n?.search===d&&this.#n?.hash===u)){if(t||r||o!==this.#e.pathname){let l=this.#t?.[o];this.#e?.disable();try{if(t||r||!l){let{default:p,config:x,layout:f,props:y}=await import(`${o}${o.endsWith("/")?"":"/"}page.js`);this.#t[o]=new U(o,document.body,x),await it(h=>bt(h)),this.#e=this.#t[o].render(f?new N(f.component,{},new N(p,y)):new N(p,y)),wt(this.#e.config)}else await it(p=>bt(p)),this.#e=l.enable(),wt(this.#e.config)}catch(p){console.log(p)}}(t||this.#n.hash!==u)&&u?.startsWith("#")&&requestAnimationFrame(()=>setTimeout(()=>{document.querySelector(u)?.scrollIntoView({behavior:"smooth"})},100)),this.#n={pathname:o,hash:u,search:d},c(o+d+u)}}async refresh(e){e||(e=this.#e.pathname),this.#t?.[e]&&delete this.#t[e],e===this.#e.pathname&&await this.navigate({refresh:!0})}async load(){this.#i||(window.addEventListener("click",e=>jt(e,this)),await this.navigate(),!(!("serviceWorker"in navigator)||!document.querySelector('head > link[rel="manifest"]'))&&navigator.serviceWorker.register(`/${G}/worker.js`).then(void 0,e=>console.log(`Service worker registration failed: ${e}`)))}get location(){return window.page?.location??window.location}emit(e,t){document.body?.dispatchEvent(new CustomEvent(e.toLowerCase(),{bubbles:!0,composed:!0,detail:t}))}on(e,t){document.body?.addEventListener(e,t,!1)}},Ne=new K;function bt(n){document.startViewTransition||!window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.startViewTransition(n):n()}a(bt,"startViewTransition");function wt(n){let e=Object.keys(n);for(let i=0,s=e.length;i<s;i++)switch(e[i]){case"title":document.title=n.title;break;case"href":document.querySelector("head > base")?.setAttribute("href",n.href);break;case"icon":var t=document.querySelectorAll('head > link[rel$="icon"]');for(let r=0,c=t.length;r<c;r++)t[r].setAttribute("href",n.icon);break;default:document.querySelector(`head > meta[name="${e[i]}"]`)?.setAttribute("content",n[e[i]]);break}}a(wt,"updateConfig");function jt(n,e){let{tagName:t,href:i,target:s}=n.target;if(t!=="A"||s&&s!=="___private"||!i)return;let r=i.replace(location.origin+"/","");n.preventDefault(),e.navigate(r?.startsWith("#")?r:i)}a(jt,"handleClick");function Tt(n){return new URL(window.location.href).host===new URL(n).host}a(Tt,"isAppUrl");var ot=class extends K{static{a(this,"BuildRouter")}#t=!1;async navigate(e){if(!this.#t)return this.#t=!0,await super.navigate(e);let{href:t}=typeof e=="object"?e:{href:e};t&&(window.location.href=Y(t)?t:new URL(t,window.location.href).href)}refresh(){location.reload()}},Q=new ot;var D=class extends A{static{a(this,"Theme")}constructor(){super("theme",{value:"auto"},"storage",{toggle:a(e=>{switch(e.value){case"light":return document.documentElement.setAttribute("theme","dark"),{value:"dark"};case"dark":return document.documentElement.removeAttribute("theme"),{value:"auto"};default:return document.documentElement.setAttribute("theme","light"),{value:"light"}}},"toggle"),set:a((e,t)=>(document.documentElement.setAttribute("theme",t),{value:t}),"set")}),document.documentElement.setAttribute("theme",this.value?.value)}};j(window,"vistta",{Fragment:O,Element:N,Context:A,Ref:T,Component:b,Suspense:M,Profiler:_,Render:dt,Safe:v,Form:R,router:Q,socket:{emit(){console.warn("Socket is not available on built apps.")},on(){console.warn("Socket is not available on built apps.")}},Theme:D});window.addEventListener("popstate",()=>Q.navigate({pushState:!1}));window.addEventListener("load",()=>Q.load());
